#!/bin/bash

oldFolder="base"

gas="Ar"
tOn=2
tOff=100
phi=2.5

D=(7 7 7 7 7 7 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.25 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 7.75 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.25 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 8.75 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.25 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 9.75 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10)
V=(42 43 44 45 46 47 16 18 20 22 23 24 26 28 30 32 33 34 36 37 38 39 40 41 42 43 44 45 46 47 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 16 17 18 20 21 22 24 26 27 28 30 32 34 36 37 38 39 40 41 42 43 44 45 46 47 17 26 27 28 29 31 32 33 34 38 40 41 42 43 44 45 46 47 16 17 18 20 22 23 24 26 28 30 32 34 36 37 38 40 41 42 43 44 45 46 47 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 16 17 18 20 22 24 26 28 30 32 34 36 38 39 40 41 42 43 44 45 46 47 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 16 18 20 22 24 26 28 30 32 34 36 38 40 41 42 43 44 45 46 47 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 38 40 41 42 43 44 45 46 47 18 25 26 27 28 29 31 32 33 34 36 37 38 39 41 42 43 44 46 47)
dV1=()
dV2=()

if [ ${#dV1[@]} -eq 0 ]; then
	dV2=($(for ((n = 0; n<${#V[@]}; n++)) do echo -n "1 " ; done))
fi 

for (( i=0; i<${#D[@]}; i++ ))
do

	if [ ${#dV1[@]} -gt 0 ]; then
		v1=$( echo "${V[i]}+${dV1[i]}-${dV2[i]}" | bc )
		v2=$( echo "${V[i]}+${dV2[i]}" | bc )
	else
		v1=${V[i]}
		v2=${V[i]}
	fi
	
	d="${D[i]}"
	
	for v in $( seq "${v1}" "-${dV2[i]}" "${v2}" )
	do
		folder="${gas}_phi_${phi}_eV_tOn_${tOn}_ns_tOff_${tOff}_ns_d_${d}_um_V_${v}_V"
		cp -rT ${oldFolder} ${folder}
		cd ${folder}
			sed -i 's?vhigh = 200E-3?vhigh = '${v}'E-3?g' "Initial.i" ;
			sed -i 's?vhigh = 200E-3?vhigh = '${v}'E-3?g' "SteadyState.i" ;
			
			sed -i 's?gap = 4E-6?gap = '${d}'E-6?g' "Initial.i" ;
			sed -i 's?gap = 4E-6?gap = '${d}'E-6?g' "SteadyState.i" ;
			
			sed -i 's?tOff = 21E-9?tOff = '${tOff}'E-9?g' "Initial.i" ;
			sed -i 's?tOff = 21E-9?tOff = '${tOff}'E-9?g' "SteadyState.i" ;
			
			sed -i 's?tOn = 0.5E-9?tOn = '${tOn}'E-9?g' "Initial.i" ;
			sed -i 's?tOn = 0.5E-9?tOn = '${tOn}'E-9?g' "SteadyState.i" ;
			
			sed -i 's?work_function = 4.00?work_function = '${phi}'?g' "Initial.i" ;
			sed -i 's?work_function = 4.00?work_function = '${phi}'?g' "SteadyState.i" ;
			
			sed -i "s?-N ${oldFolder}?-N ${folder}?g" "Submission.job" ;
			
			qsub Submission.job
		cd ..
	done
done
